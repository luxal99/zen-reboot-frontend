<div class="dialog">
  <div class="row">
    <div class="col-6">
      <h1 style="padding-top: 2em"><b>Kreiranje vaučera</b></h1>
    </div>
    <div class="col-6 text-right">
      <button mat-icon-button mat-dialog-close>
        <mat-icon>close</mat-icon>
      </button>
    </div>
  </div>
  <div class="row">
    <div class="col-6" style="padding-left: 0">
      <app-form-date [config]="startDateInput" [group]="voucherForm"></app-form-date>
    </div>
    <div class="col-6" style="padding-right: 0">
      <app-form-date [config]="endDateInput" [group]="voucherForm"></app-form-date>
    </div>
  </div>
  <app-form-select label="Tip vaučera"
                   [group]="voucherForm"
                   *ngIf="!data"
                   (onChange)="onVoucherTypeSelect()"
                   [config]="typeSelectConfig"></app-form-select>
  <app-form-input label="Iznos" [config]="priceInputConfig"
                  *ngIf="isDisplayTypeBlanco && !data"
                  [group]="voucherForm"></app-form-input>
  <div class="row">
    <div class="col-6" style="padding-left: 0">
      <app-form-input [group]="voucherForm" *ngIf="!data" label="Popust"
                      [config]="discountInputConfig"></app-form-input>
    </div>
    <div class="col-6" style="padding-right: 0">
      <app-form-select [config]="discountTypeSelectConfig"
                       *ngIf="!data"
                       label="Tip popusta"
                       [group]="voucherForm"></app-form-select>
    </div>
  </div>
  <app-form-select label="Način plaćanja"
                   *ngIf="!data"
                   [group]="voucherForm"
                   [config]="paymentMethodSelectConfig"></app-form-select>
  <form [formGroup]="voucherForm" *ngIf="!data">
    <mat-form-field appearance="outline">
      <mat-label>Tretman</mat-label>
      <mat-select [compareWith]="compareObjects" formControlName="treatmentDurations" multiple>
        <mat-optgroup *ngFor="let group of listOfTreatments" [label]="group.name" required="true">
          <mat-option *ngFor="let treatmentDuration of group.durations" [value]="treatmentDuration">
            {{treatmentDuration.duration}}
          </mat-option>
        </mat-optgroup>
      </mat-select>
    </mat-form-field>
  </form>
  <mat-accordion *ngIf="!data">
    <mat-expansion-panel>
      <mat-expansion-panel-header><h4><b>Klijenti</b></h4></mat-expansion-panel-header>
      <div class="client">
        <div class="row">
          <div class="col-6">
            <form [formGroup]="searchForm">
              <mat-form-field appearance="outline">
                <mat-label>Pretraži</mat-label>
                <input (input)="search()" matInput formControlName="search" [(ngModel)]="searchText">
                <mat-icon matSuffix>
                  search
                </mat-icon>
              </mat-form-field>
            </form>
          </div>
          <div class="col-6">
            <app-paginator (next)="getNext()" (prev)="getPrevious()"></app-paginator>
          </div>
        </div>
        <div class="row client-row" style="padding-top: 1em" *ngFor="let client of listOfClients"
             (click)="selectClient(client,$event)">
          <div class="col-sm">
            <div class="inline">
              <h1 class="first-letter-h1">{{client.person.firstName.substr(0, 1)}}</h1>
              <h2>{{client.person?.firstName}}</h2>
            </div>
          </div>
          <div class="col-sm">
            <h2>{{client.person?.lastName}}</h2>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>


  <mat-spinner #spinner diameter="25"></mat-spinner>

  <button class="default-btn" (click)="save()" [disabled]="!data ? !voucherForm.valid:false" mat-button>
    Sačuvaj
  </button>
</div>
